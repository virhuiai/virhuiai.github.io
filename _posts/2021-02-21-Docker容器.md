---
layout: post
title:  "Dockerå®¹å™¨"
date:   2021-02-21 20:58:16 +0800
categories: Docker å®¹å™¨
rname-cmd: 

typora-root-url: ../
---

> é•œåƒ-ç±»-- -åªè¯»
>
> å®¹å™¨-å®¹å™¨-å¯å†™ï¼ˆå¸¦æœ‰è¿è¡Œæ—¶éœ€è¦çš„å¯å†™æ–‡ä»¶å±‚ï¼‰

# å®ä¾‹

## è¿è¡Œbashåº”ç”¨

è¿è¡Œbashåº”ç”¨ï¼Œæ‰§è¡Œæ‰“å°â€œHello Worldâ€å‘½ä»¤ï¼š

```bash
$ docker run -it ubuntu:18.04 bash
root@65663247040f:/# echo "Hello World"
Hello World
root@65663247040f:/# exit
```

# å®¹å™¨æ“ä½œ

## create-æ–°å»ºå®¹å™¨

ä½¿ç”¨`docker [container] create`å‘½ä»¤æ–°å»ºçš„å®¹å™¨å¤„äºåœæ­¢çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨`docker [container] start`å‘½ä»¤æ¥å¯åŠ¨å®ƒï¼š

```
docker create [OPTIONS] IMAGE [COMMAND] [ARG...]
```

![image-20210222202611157](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222202611157.png)

```
docker create --help
```

`ä¾‹å­`ï¼š

```
docker create -it ubuntu:latest
```

```bash
$ docker create -it ubuntu:latest
af8f4f922dafee22c8fe6cd2ae11d16e25087d61f1b1fa55b36e94db7ef45178
$ docker ps -a
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
af8f4f922daf ubuntu:latest "/bin/bash" 17 seconds ago Created silly_euler
```



### é€‰é¡¹-åˆ—è¡¨-å…¨

- `--add-host list`ï¼š
  Add a custom host-to-IP mapping (host:ip)
  æ·»åŠ è‡ªå®šä¹‰ä¸»æœºåˆ°IPçš„æ˜ å°„

  åœ¨å®¹å™¨å†…æ·»åŠ ä¸€ä¸ªä¸»æœºååˆ°IPåœ°å€çš„æ˜ å°„å…³ç³»ï¼ˆé€šè¿‡/etc/hostsæ–‡ä»¶ï¼‰

- `-a, --attach list`ï¼š

  `--attach=[]`

  Attach to STDIN, STDOUT or STDERR

  æ˜¯å¦ç»‘å®šåˆ°æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯

- `--blkio-weight uint16`ï¼š
  Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)
  å—IOï¼ˆç›¸å¯¹æƒé‡ï¼‰ï¼Œä»‹äº10åˆ°1000ä¹‹é—´ï¼Œæˆ–è€…ä¸º0ç¦ç”¨ï¼ˆé»˜è®¤ä¸º0ï¼‰

  å®¹å™¨è¯»å†™å—è®¾å¤‡çš„I/Oæ€§èƒ½æƒé‡,é»˜è®¤ä¸º0

- `--blkio-weight-device list`ï¼š
  Block IO weight (relative device weight) (default [])
  å—IOæƒé‡ï¼ˆç›¸å¯¹è®¾å¤‡æƒé‡ï¼‰ï¼ˆé»˜è®¤ä¸º[]ï¼‰

  æŒ‡å®šå„ä¸ªå—è®¾å¤‡çš„I/Oæ€§èƒ½æƒé‡

- `--cap-add list`ï¼š
  Add Linux capabilities

  å¢åŠ å®¹å™¨çš„ LinuxæŒ‡å®šå®‰å…¨èƒ½åŠ›

- `--cap-drop list`ï¼š
  Drop Linux capabilities

  ç§»é™¤å®¹å™¨çš„ LinuxæŒ‡å®šå®‰å…¨èƒ½åŠ›

- `--cgroup-parent string`ï¼š
  Optional parent cgroup for the container
  å®¹å™¨çš„å¯é€‰çˆ¶cgroup

  å®¹å™¨ groupsé™åˆ¶çš„åˆ›å»ºè·¯å¾„

- `--cgroupns string`:
  Cgroup namespace to use (host|private)
  è¦ä½¿ç”¨çš„Cgroupå‘½åç©ºé—´(host|private)
  - `'host'`:    
    Run the container in the Docker host's cgroup namespace
    åœ¨Dockerä¸»æœºçš„cgroupå‘½åç©ºé—´ä¸­è¿è¡Œå®¹å™¨
  - `'private'`: 
    Run the container in its own private cgroup namespace
    åœ¨è‡ªå·±çš„ç§æœ‰cgroupå‘½åç©ºé—´ä¸­è¿è¡Œå®¹å™¨
  - `''`:        
    Use the cgroup namespace as configured by the default-cgroupns-mode option on the daemon (default)
    ä½¿ç”¨å®ˆæŠ¤ç¨‹åºä¸Šdefault-cgroupns-modeé€‰é¡¹é…ç½®çš„cgroupå‘½åç©ºé—´ï¼ˆé»˜è®¤ï¼‰
  
- `--cidfile string`ï¼š
  Write the container ID to the file
  å°†å®¹å™¨IDå†™å…¥æ–‡ä»¶

  æŒ‡å®šå®¹å™¨çš„è¿›ç¨‹IDå·å†™åˆ°æ–‡ä»¶

- `--cpu-period int`ï¼š
  Limit CPU CFS (Completely Fair Scheduler) period
  Limit CPU CFSï¼ˆå®Œå…¨å…¬å¹³çš„è°ƒåº¦ç¨‹åºï¼‰period

  é™åˆ¶å®¹å™¨åœ¨CFSè°ƒåº¦å™¨ä¸‹çš„CPUå ç”¨æ—¶é—´ç‰‡

- `--cpu-quota int`ï¼š
  Limit CPU CFS (Completely Fair Scheduler) quota
  Limit CPU CFSï¼ˆå®Œå…¨å…¬å¹³çš„è°ƒåº¦ç¨‹åºï¼‰é…é¢

  é™åˆ¶å®¹å™¨åœ¨CFSè°ƒåº¦å™¨ä¸‹çš„CPUé…é¢

- `--cpu-rt-period int`ï¼š
  Limit CPU real-time period in microseconds
  é™åˆ¶CPUå®æ—¶æ—¶é—´ï¼ˆä»¥å¾®ç§’ä¸ºå•ä½ï¼‰

- `--cpu-rt-runtime int`ï¼š
  Limit CPU real-time runtime in microseconds
  é™åˆ¶CPUå®æ—¶è¿è¡Œæ—¶é—´ï¼ˆä»¥å¾®ç§’ä¸ºå•ä½ï¼‰

- `-c, --cpu-shares int`ï¼š
  CPU shares (relative weight)
  CPUä»½é¢ï¼ˆç›¸å¯¹é‡é‡ï¼‰

  å…è®¸å®¹å™¨ä½¿ç”¨CPUèµ„æºçš„ç›¸å¯¹æƒé‡,é»˜è®¤ä¸€ä¸ªå®¹å™¨èƒ½ç”¨æ»¡ä¸€ä¸ªæ ¸çš„CPU

- `--cpus decimal`ï¼š
  Number of CPUs
  CPUæ•°é‡

- `--cpuset-cpus string`ï¼š
  CPUs in which to allow execution (0-3, 0,1)
  å…è®¸æ‰§è¡Œçš„CPUï¼ˆ0-3ï¼Œ0,1ï¼‰

  é™åˆ¶å®¹å™¨èƒ½ä½¿ç”¨å“ªäº›CPUæ ¸å¿ƒ

- `--cpuset-mems string`ï¼š
  MEMs in which to allow execution (0-3, 0,1)
  å…è®¸æ‰§è¡Œçš„MEMï¼ˆ0-3ï¼Œ0,1ï¼‰

  NUMAæ¶æ„ä¸‹ä½¿ç”¨å“ªäº›æ ¸å¿ƒçš„å†…å­˜??

- `--device list`ï¼š
  Add a host device to the container
  å°†ä¸»æœºè®¾å¤‡æ·»åŠ åˆ°å®¹å™¨

  æ˜ å°„ç‰©ç†æœºä¸Šçš„è®¾å¤‡åˆ°å®¹å™¨å†…

- `--device-cgroup-rule list`ï¼š
  Add a rule to the cgroup allowed devices list
  å°†è§„åˆ™æ·»åŠ åˆ°cgroupå…è®¸çš„è®¾å¤‡åˆ—è¡¨ä¸­

- `--device-read-bps list`ï¼š
  Limit read rate (bytes per second) from a device (default [])
  é™åˆ¶ä»è®¾å¤‡è¯»å–çš„é€Ÿç‡ï¼ˆæ¯ç§’å­—èŠ‚æ•°ï¼‰ï¼ˆé»˜è®¤ä¸º[]ï¼‰

  æŒ‚è½½è®¾å¤‡çš„è¯»ååç‡(ä»¥bpsä¸ºå•ä½)é™åˆ¶

- `--device-read-iops list`ï¼š
  Limit read rate (IO per second) from a device (default [])
  é™åˆ¶ä»è®¾å¤‡è¯»å–çš„é€Ÿç‡ï¼ˆæ¯ç§’IOï¼‰ï¼ˆé»˜è®¤[]ï¼‰

  æŒ‚è½½è®¾å¤‡çš„è¯»é€Ÿç‡(ä»¥æ¯ç§’i/oæ¬¡æ•°ä¸ºå•ä½)é™åˆ¶

- `--device-write-bps list`ï¼š
  Limit write rate (bytes per second) to a device (default [])
  å°†å†™å…¥é€Ÿç‡ï¼ˆæ¯ç§’çš„å­—èŠ‚æ•°ï¼‰é™åˆ¶ä¸ºè®¾å¤‡ï¼ˆé»˜è®¤ä¸º[]ï¼‰

  æŒ‚è½½è®¾å¤‡çš„å†™ååç‡(ä»¥bpsä¸ºå•ä½)é™åˆ¶

- `--device-write-iops list`ï¼š
  Limit write rate (IO per second) to a device (default [])
  å°†å†™å…¥é€Ÿç‡ï¼ˆæ¯ç§’çš„IOï¼‰é™åˆ¶ä¸ºè®¾å¤‡ï¼ˆé»˜è®¤ä¸º[]ï¼‰

  æŒ‚è½½è®¾å¤‡çš„å†™é€Ÿç‡(ä»¥æ¯ç§’i/oæ¬¡æ•°ä¸ºå•ä½)é™åˆ¶

- `--disable-content-trust`ï¼š
  Skip image verification (default true)
  è·³è¿‡å®¹å™¨éªŒè¯ï¼ˆé»˜è®¤ä¸ºtrueï¼‰

- `--dns list`ï¼š
  Set custom DNS servers
  è®¾ç½®è‡ªå®šä¹‰DNSæœåŠ¡å™¨

  è‡ªå®šä¹‰çš„DNSæœåŠ¡å™¨

- `--dns-option list`ï¼š
  Set DNS options
  è®¾å®šDNSé€‰é¡¹

  è‡ªå®šä¹‰çš„DNSé€‰é¡¹

- `--dns-search list`ï¼š
  Set custom DNS search domains
  è®¾ç½®è‡ªå®šä¹‰DNSæœç´¢åŸŸ

  DNSæœç´¢åŸŸ

- `--domainname string`ï¼š
  Container NIS domain name
  å®¹å™¨NISåŸŸå

- `--entrypoint string`ï¼š
  Overwrite the default ENTRYPOINT of the image
  è¦†ç›–å®¹å™¨çš„é»˜è®¤ENTRYPOINT

  é•œåƒå­˜åœ¨å…¥å£å‘½ä»¤æ—¶ï¼Œè¦†ç›–ä¸ºæ–°çš„å‘½ä»¤

- `-e, --env list`ï¼š
  Set environment variables
  è®¾ç½®ç¯å¢ƒå˜é‡

  æŒ‡å®šå®¹å™¨å†…ç¯å¢ƒå˜é‡

- `--env-file list`ï¼š
  Read in a file of environment variables
  è¯»å…¥ç¯å¢ƒå˜é‡æ–‡ä»¶

  ä»æ–‡ä»¶ä¸­è¯»å–ç¯å¢ƒå˜é‡åˆ°å®¹å™¨å†…

- `--expose list`ï¼š
  Expose a port or a range of ports
  å…¬å¼€ä¸€ä¸ªæˆ–å¤šä¸ªç«¯å£

  æŒ‡å®šå®¹å™¨ä¼šæš´éœ²å‡ºæ¥çš„ç«¯å£æˆ–ç«¯å£èŒƒå›´

- `--gpus gpu-request`ï¼š
  GPU devices to add to the container ('all' to pass all GPUs)
  è¦æ·»åŠ åˆ°å®¹å™¨ä¸­çš„GPUè®¾å¤‡ï¼ˆ`'all'`æŒ‡å®šæ‰€æœ‰GPUï¼‰

- `--group-add list`ï¼š
  Add additional groups to join
  æ·»åŠ å…¶ä»–ç¾¤ç»„åŠ å…¥

  è¿è¡Œå®¹å™¨çš„ç”¨æˆ·ç»„

- `--health-cmd string`ï¼š
  Command to run to check health
  è¿è¡Œå‘½ä»¤ä»¥æ£€æŸ¥è¿è¡ŒçŠ¶å†µ

  æŒ‡å®šæ£€æŸ¥å®¹å™¨å¥åº·çŠ¶æ€çš„å‘½ä»¤

- `--health-interval duration`ï¼š
  Time between running the check (ms|s|m|h) (default 0s)
  è¿è¡Œæ£€æŸ¥ä¹‹é—´çš„æ—¶é—´é—´éš”ï¼ˆ`ms | s | m | h`ï¼‰ï¼ˆé»˜è®¤ä¸º0sï¼‰

  æ‰§è¡Œå¥åº·æ£€æŸ¥çš„é—´éš”æ—¶é—´,å•ä½å¯ä»¥ä¸ºmsã€sã€mæˆ–h

- `--health-retries int`ï¼š
  Consecutive failures needed to report unhealthy
  éœ€è¦æŠ¥å‘Šä¸å¥åº·çš„è¿ç»­å¤±è´¥æ•°

  å¥åº·æ£€æŸ¥å¤±è´¥é‡è¯•æ¬¡æ•°,è¶…è¿‡åˆ™è®¤ä¸ºä¸å¥åº·

- `--health-start-period duration`ï¼š
  Start period for the container to initialize before starting health-retries countdown (ms|s|m|h) (default 0s)
  å¼€å§‹è¿è¡ŒçŠ¶å†µé‡è¯•å€’è®¡æ—¶ä¹‹å‰ï¼Œå®¹å™¨åˆå§‹åŒ–çš„å¼€å§‹æ—¶é—´ï¼ˆæ¯«ç§’|ç§’|ç±³|å°æ—¶ï¼‰ï¼ˆé»˜è®¤ä¸º0ç§’ï¼‰

  å®¹å™¨å¯åŠ¨åè¿›è¡Œå¥åº·æ£€æŸ¥çš„ç­‰å¾…æ—¶é—´,å•ä½å¯ä»¥ä¸ºmsã€sã€mæˆ–h

- `--health-timeout duration`ï¼š
  Maximum time to allow one check to run (ms|s|m|h) (default 0s)
  å…è®¸æ‰§è¡Œä¸€æ¬¡æ£€æŸ¥çš„æœ€å¤§æ—¶é—´ï¼ˆms | s | m | hï¼‰ï¼ˆé»˜è®¤ä¸º0sï¼‰

  å¥åº·æ£€æŸ¥çš„æ‰§è¡Œè¶…æ—¶,å•ä½å¯ä»¥ä¸ºmsã€sã€mæˆ–h

- `--help`ï¼š
  Print usage

- `-h, --hostname string`ï¼š
  Container host name
  å®¹å™¨ä¸»æœºå

  æŒ‡å®šå®¹å™¨å†…çš„ä¸»æœºå

- `--init`ï¼š
  Run an init inside the container that forwards signals and reaps processes
  åœ¨å®¹å™¨å†…è¿è¡Œä¸€ä¸ªåˆå§‹åŒ–ç¨‹åºï¼Œä»¥è½¬å‘ä¿¡å·å¹¶è·å–è¿›ç¨‹

  åœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸€ä¸ªinitè¿›ç¨‹,æ¥è´Ÿè´£å“åº”ä¿¡å·å’Œå¤„ç†åƒµå°¸çŠ¶æ€å­è¿›ç¨‹

- `-i, --interactive`ï¼š
  Keep STDIN open even if not attached
  å³ä½¿æœªè¢«è¿æ¥STDINä¹Ÿä¿æŒæ‰“å¼€çŠ¶æ€

  ä¿æŒæ ‡å‡†è¾“å…¥æ‰“å¼€ï¼Œé»˜è®¤ä¸ºfalse

- `--ip string`ï¼š
  IPv4 address (e.g., 172.30.100.104)
  IPv4åœ°å€

  æŒ‡å®šå®¹å™¨çš„IPv4åœ°å€

- `--ip6 string`ï¼š
  IPv6 address (e.g., 2001:db8::33)
  IPv6åœ°å€

  æŒ‡å®šå®¹å™¨çš„IPv6åœ°å€

- `--ipc string`ï¼š
  IPC mode to use
  ä½¿ç”¨çš„IPCæ¨¡å¼

  å®¹å™¨IPCå‘½åç©ºé—´ï¼Œå¯ä»¥ä¸ºå…¶ä»–å®¹å™¨æˆ–ä¸»æœº

- `--isolation string`ï¼š
  Container isolation technology
  å®¹å™¨éš”ç¦»æŠ€æœ¯

  å®¹å™¨ä½¿ç”¨çš„éš”ç¦»æœºåˆ¶ï¼Œå¦‚"default"

- `--kernel-memory bytes`ï¼š
  Kernel memory limit
  å†…æ ¸å†…å­˜é™åˆ¶

  é™åˆ¶å®¹å™¨ä½¿ç”¨å†…æ ¸çš„å†…å­˜å¤§å°,å•ä½å¯ä»¥æ˜¯bã€kã€mæˆ–g

- `-l, --label list`ï¼š
  Set meta data on a container
  åœ¨å®¹å™¨ä¸Šè®¾ç½®å…ƒæ•°æ®

  ä»¥é”®å€¼å¯¹æ–¹å¼æŒ‡å®šå®¹å™¨çš„æ ‡ç­¾ä¿¡æ¯ï¼›

- `--label-file list`ï¼š
  Read in a line delimited file of labels
  è¯»å…¥è¡Œåˆ†éš”çš„æ ‡ç­¾æ–‡ä»¶

  ä»æ–‡ä»¶ä¸­è¯»å–æ ‡ç­¾ä¿¡æ¯

- `--link list`ï¼š
  Add link to another container
  å°†é“¾æ¥æ·»åŠ åˆ°å¦ä¸€ä¸ªå®¹å™¨

  é“¾æ¥åˆ°å…¶ä»–å®¹å™¨(name or id)

- `--link-local-ip list`ï¼š
  Container IPv4/IPv6 link-local addresses
  å®¹å™¨IPv4 / IPv6é“¾æ¥æœ¬åœ°åœ°å€

  å®¹å™¨çš„æœ¬åœ°é“¾æ¥åœ°å€åˆ—è¡¨

- `--log-driver string`ï¼š
  Logging driver for the container
  å®¹å™¨çš„æ—¥å¿—è®°å½•é©±åŠ¨ç¨‹åº

  æŒ‡å®šå®¹å™¨çš„æ—¥å¿—é©±åŠ¨ç±»å‹ï¼Œå¯ä»¥ä¸ºjson-fileã€syslogã€journaldã€ gelfã€fluentdã€awslogsã€splunkã€etwlogsã€gcplogsæˆ– none

- `--log-opt list`ï¼š
  Log driver options
  æ—¥å¿—é©±åŠ¨ç¨‹åºé€‰é¡¹

  ä¼ é€’ç»™æ—¥å¿—é©±åŠ¨çš„é€‰é¡¹

- `--mac-address string`ï¼š
  Container MAC address (e.g., 92:d0:c6:0a:29:33)
  å®¹å™¨MACåœ°å€

  æŒ‡å®šå®¹å™¨çš„Macåœ°å€

- `-m, --memory bytes`ï¼š
  Memory limit
  å†…å­˜é™åˆ¶

  é™åˆ¶å®¹å™¨å†…åº”ç”¨ä½¿ç”¨çš„å†…å­˜,å•ä½å¯ä»¥æ˜¯bã€kã€mæˆ–g

- `--memory-reservation bytes`ï¼š
  Memory soft limit
  å†…å­˜è½¯é™åˆ¶

  å½“ç³»ç»Ÿä¸­å†…å­˜è¿‡ä½æ—¶,å®¹å™¨ä¼šè¢«å¼ºåˆ¶é™åˆ¶å†…å­˜åˆ°ç»™å®šå€¼,é»˜è®¤æƒ…å†µä¸‹ç­‰äºå†…å­˜é™åˆ¶å€¼

- `--memory-swap bytes`ï¼š
  Swap limit equal to memory plus swap: '-1' to enable unlimited swap
  äº¤æ¢é™åˆ¶ç­‰äºå†…å­˜åŠ äº¤æ¢ï¼šâ€œ-1â€ä»¥å¯ç”¨æ— é™äº¤æ¢

  é™åˆ¶å®¹å™¨ä½¿ç”¨å†…å­˜å’Œäº¤æ¢åŒºçš„æ€»å¤§å°

- `--memory-swappiness int`ï¼š
  Tune container memory swappiness (0 to 100) (default -1)
  è°ƒä¼˜å®¹å™¨å†…å­˜äº¤æ¢ï¼ˆ0åˆ°100ï¼‰ï¼ˆé»˜è®¤-1ï¼‰

  è°ƒæ•´å®¹å™¨çš„å†…å­˜äº¤æ¢åŒºå‚æ•°

- `--mount mount`ï¼š
  Attach a filesystem mount to the container
  å°†æ–‡ä»¶ç³»ç»ŸæŒ‚è½½é™„åŠ åˆ°å®¹å™¨

- `--name string`ï¼š
  Assign a name to the container
  ä¸ºå®¹å™¨åˆ†é…ä¸€ä¸ªåç§°

  æŒ‡å®šå®¹å™¨çš„åˆ«å

- `--network network`ï¼š
  Connect a container to a network
  å°†å®¹å™¨è¿æ¥åˆ°ç½‘ç»œ

  æŒ‡å®šå®¹å™¨ç½‘ç»œæ¨¡å¼ï¼ŒåŒ…æ‹¬bridgeã€noneã€å…¶ä»–å®¹å™¨å†…ç½‘ç»œã€hostçš„ç½‘ç»œæˆ–æŸä¸ªç°æœ‰ç½‘ç»œç­‰

- `--network-alias list`ï¼š

  Add network-scoped alias for the container
  ä¸ºå®¹å™¨æ·»åŠ ç½‘ç»œèŒƒå›´çš„åˆ«å

- `--no-healthcheck`ï¼š
  Disable any container-specified HEALTHCHECK
  ç¦ç”¨ä»»ä½•å®¹å™¨æŒ‡å®šçš„å¥åº·æ£€æŸ¥

  æ˜¯å¦ç¦ç”¨å¥åº·æ£€æŸ¥

- `--oom-kill-disable`ï¼š
  Disable OOM Killer
  ç¦ç”¨OOM Killer

  å†…å­˜è€—å°½æ—¶æ˜¯å¦æ€æ­»å®¹å™¨

- `--oom-score-adj int`ï¼š
  Tune host's OOM preferences (-1000 to 1000)
  Tune host's OOM é¦–é€‰é¡¹ï¼ˆ-1000è‡³1000ï¼‰

  è°ƒæ•´å®¹å™¨çš„å†…å­˜è€—å°½å‚æ•°

- `--pid string`ï¼š
  PID namespace to use
  ä½¿ç”¨çš„PIDåç§°ç©ºé—´

  å®¹å™¨çš„PIDå‘½åç©ºé—´

- `--pids-limit int`ï¼š
  Tune container pids limit (set -1 for unlimited)
  Tuneå®¹å™¨pidsé™åˆ¶ï¼ˆå°†-1è®¾ç½®ä¸ºæ— é™åˆ¶ï¼‰

  é™åˆ¶å®¹å™¨çš„pidä¸ªæ•°

- `--platform string`ï¼š
  Set platform if server is multi-platform capable
  å¦‚æœæœåŠ¡å™¨æ”¯æŒå¤šå¹³å°ï¼Œåˆ™è®¾ç½®å¹³å°

- `--privileged`ï¼š
  Give extended privileges to this container
  èµ‹äºˆæ­¤å®¹å™¨æ‰©å±•çš„ç‰¹æƒ

  ğŸ’«æ˜¯å¦ç»™å®¹å™¨é«˜æƒé™,è¿™æ„å‘³ç€å®¹å™¨å†…åº”ç”¨å°†ä¸å—æƒé™çš„é™åˆ¶.ä¸€èˆ¬ä¸æ¨è

- `-p, --publish list`ï¼š
  Publish a container's port(s) to the host
  å°†å®¹å™¨çš„ç«¯å£å‘å¸ƒåˆ°ä¸»æœº

  æŒ‡å®šå¦‚ä½•æ˜ å°„åˆ°æœ¬åœ°ä¸»æœºç«¯å£ï¼Œä¾‹å¦‚-p 11234-12234:1234-2234

- `-P, --publish-all`ï¼š
  Publish all exposed ports to random ports
  å°†æ‰€æœ‰å…¬å¼€çš„ç«¯å£å‘å¸ƒåˆ°éšæœºç«¯å£

  é€šè¿‡NATæœºåˆ¶å°†å®¹å™¨æ ‡è®°æš´éœ²çš„ç«¯å£è‡ªåŠ¨æ˜ å°„åˆ°æœ¬åœ°ä¸»æœºçš„ä¸´æ—¶ç«¯å£

- `--pull string`ï¼š
  Pull image before creating ("always"|"missing"|"never") (default "missing")
  åˆ›å»ºå‰æ‹‰å–é•œåƒ

- `--read-only`ï¼š
  Mount the container's root filesystem as read only
  å°†å®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸ºåªè¯»

  æ˜¯å¦è®©å®¹å™¨å†…çš„æ–‡ä»¶ç³»ç»Ÿåªè¯»

- `--restart string`ï¼š
  Restart policy to apply when a container exits (default "no")
  å®¹å™¨é€€å‡ºæ—¶é‡æ–°å¯åŠ¨ç­–ç•¥ä»¥åº”ç”¨ï¼ˆé»˜è®¤ä¸ºâ€œå¦â€ï¼‰

  å®¹å™¨çš„é‡å¯ç­–ç•¥ï¼ŒåŒ…æ‹¬noã€on-failure [:max-retry]ã€alwaysã€ unless-stopped ç­‰

- `--rm`ï¼š
  Automatically remove the container when it exits
  é€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤å®¹å™¨

  å®¹å™¨é€€å‡ºåæ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œä¸èƒ½è·Ÿ`-d`åŒæ—¶ä½¿ç”¨

- `--runtime string`ï¼š
  Runtime to use for this container
  ç”¨äºæ­¤å®¹å™¨çš„è¿è¡Œæ—¶

- `--security-opt list`ï¼š
  Security Options
  å®‰å…¨é€‰é¡¹

  æŒ‡å®šä¸€äº›å®‰å…¨å‚æ•°,åŒ…æ‹¬æƒé™ã€å®‰å…¨èƒ½åŠ›ã€ apparmorç­‰

- `--shm-size bytes`ï¼š
  Size of /dev/shm

  dev/shmçš„å¤§å°

- `--stop-signal string`ï¼š
  Signal to stop a container (default "SIGTERM")
  åœæ­¢å®¹å™¨çš„ä¿¡å·

  æŒ‡å®šåœæ­¢å®¹å™¨çš„ç³»ç»Ÿä¿¡å·

- `--stop-timeout int`ï¼š
  Timeout (in seconds) to stop a container
  åœæ­¢å®¹å™¨çš„è¶…æ—¶æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰

- `--storage-opt list`ï¼š
  Storage driver options for the container
  å®¹å™¨çš„å­˜å‚¨é©±åŠ¨ç¨‹åºé€‰é¡¹

- `--sysctl map`ï¼š
  Sysctl options (default map[])
  Sysctlé€‰é¡¹ï¼ˆé»˜è®¤æ˜ å°„[]ï¼‰

- `--tmpfs list`ï¼š
  Mount a tmpfs directory
  æŒ‚è½½tmpfsç›®å½•

  æŒ‚è½½ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿåˆ°å®¹å™¨

- `-t, --tty`ï¼š
  Allocate a pseudo-TTY
  åˆ†é…ä¼ªTTY

  æ˜¯å¦åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼Œé»˜è®¤ä¸ºfalse

- `--ulimit ulimit`ï¼š
  Ulimit options (default [])
  Ulimité€‰é¡¹ï¼ˆé»˜è®¤[]ï¼‰

  é€šè¿‡ulimitæ¥é™åˆ¶æœ€å¤§æ–‡ä»¶æ•°ã€æœ€å¤§è¿›ç¨‹æ•°ç­‰

- `-u, --user string`ï¼š
  Username or UID (format: <name|uid>[:<group|gid>])
  ç”¨æˆ·åæˆ–UID

  æŒ‡å®šåœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤çš„ç”¨æˆ·ä¿¡æ¯

- `--userns string`ï¼š
  User namespace to use
  è¦ä½¿ç”¨çš„ç”¨æˆ·åç§°ç©ºé—´

  æŒ‡å®šç”¨æˆ·å‘½åç©ºé—´

- å¯ç”¨userns-remapæ—¶é…ç½®ç”¨æˆ·å‘½åç©ºé—´çš„æ¨¡å¼

- `--uts string`ï¼š
  UTS namespace to use
  ä½¿ç”¨çš„UTSåç§°ç©ºé—´

  å®¹å™¨çš„UTSå‘½åç©ºé—´

- `-v, --volume list`ï¼š

  `--volume [=[[HOST-DIR:]CONTAINER-DIR[:OPTIONS]]]`

  Bind mount a volume
  ç»‘å®šæŒ‚è½½å·

- `--volume-driver string`ï¼š
  Optional volume driver for the container
  å®¹å™¨çš„å¯é€‰å·é©±åŠ¨å™¨

  æŒ‚è½½æ–‡ä»¶å·çš„é©±åŠ¨ç±»å‹

- `--volumes-from list`ï¼š
  Mount volumes from the specified container(s)
  ä»æŒ‡å®šçš„å®¹å™¨æŒ‚è½½å·

- `-w, --workdir string`ï¼š
Working directory inside the container
å®¹å™¨å†…çš„é»˜è®¤å·¥ä½œç›®å½•

å…¶ä»–åœ°æ–¹æŸ¥åˆ°çš„

- `--sig-proxy=true|false`ï¼š

  æ˜¯å¦ä»£ç†æ”¶åˆ°çš„ä¿¡å·ç»™åº”ç”¨,é»˜è®¤ä¸ºtrue,ä¸èƒ½ä»£ç† SIGCHLDã€SIGSTOPå’Œ SIGKILLä¿¡å·

  æ˜¯å¦ä»£ç†æ”¶åˆ°çš„ç³»ç»Ÿä¿¡å·ç»™åº”ç”¨è¿›ç¨‹ï¼Œé»˜è®¤ä¸ºtrueã€‚

### é€‰é¡¹-è¡¨æ ¼-åˆ†ç±»

#### è¿è¡Œæ¨¡å¼ç›¸å…³

createå‘½ä»¤ä¸å®¹å™¨è¿è¡Œæ¨¡å¼ç›¸å…³çš„é€‰é¡¹

| é€‰ é¡¹                                              | è¯´ æ˜                                                        |
| -------------------------------------------------- | ------------------------------------------------------------ |
| `-a, --attach list`                                | æ˜¯å¦ç»‘å®šåˆ°æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯                               |
| `-d, --detach`                                     | æ˜¯å¦åœ¨åå°è¿è¡Œå®¹å™¨ï¼Œé»˜è®¤ä¸ºå¦                                 |
| `--detach-keys string`                             | ä»attachæ¨¡å¼é€€å‡ºçš„å¿«æ·é”®                                     |
| `--entrypoint string`                              | é•œåƒå­˜åœ¨å…¥å£å‘½ä»¤æ—¶ï¼Œè¦†ç›–ä¸ºæ–°çš„å‘½ä»¤                           |
| `--expose list`                                    | æŒ‡å®šå®¹å™¨ä¼šæš´éœ²å‡ºæ¥çš„ç«¯å£æˆ–ç«¯å£èŒƒå›´                           |
| `--group-add list`                                 | è¿è¡Œå®¹å™¨çš„ç”¨æˆ·ç»„                                             |
| `-i, --interactive`                                | ä¿æŒæ ‡å‡†è¾“å…¥æ‰“å¼€ï¼Œé»˜è®¤ä¸ºfalse                                |
| `--ipc string`                                     | å®¹å™¨IPCå‘½åç©ºé—´ï¼Œå¯ä»¥ä¸ºå…¶ä»–å®¹å™¨æˆ–ä¸»æœº                        |
| `--isolation string`                               | å®¹å™¨ä½¿ç”¨çš„éš”ç¦»æœºåˆ¶ï¼Œå¦‚"default"                              |
| `--log-driver string`                              | æŒ‡å®šå®¹å™¨çš„æ—¥å¿—é©±åŠ¨ç±»å‹ï¼Œå¯ä»¥ä¸ºjson-fileã€syslogã€journaldã€ gelfã€fluentdã€awslogsã€splunkã€etwlogsã€gcplogsæˆ– none |
| `--log-opt list`                                   | ä¼ é€’ç»™æ—¥å¿—é©±åŠ¨çš„é€‰é¡¹                                         |
| `--network network`                                | æŒ‡å®šå®¹å™¨ç½‘ç»œæ¨¡å¼ï¼ŒåŒ…æ‹¬bridgeã€noneã€å…¶ä»–å®¹å™¨å†…ç½‘ç»œã€hostçš„ ç½‘ç»œæˆ–æŸä¸ªç°æœ‰ç½‘ç»œç­‰ |
| `--net-alias list`                                 | å®¹å™¨åœ¨ç½‘ç»œä¸­çš„åˆ«å                                           |
| `-P, --publish-all`                                | é€šè¿‡NATæœºåˆ¶å°†å®¹å™¨æ ‡è®°æš´éœ²çš„ç«¯å£è‡ªåŠ¨æ˜ å°„åˆ°æœ¬åœ°ä¸»æœºçš„ä¸´æ—¶ç«¯å£  |
| `-p, --publish list`                               | æŒ‡å®šå¦‚ä½•æ˜ å°„åˆ°æœ¬åœ°ä¸»æœºç«¯å£ï¼Œä¾‹å¦‚-p 11234-12234:1234-2234     |
| `--pid string`                                     | å®¹å™¨çš„PIDå‘½åç©ºé—´                                            |
| `--userns string`                                  | å¯ç”¨userns-remapæ—¶é…ç½®ç”¨æˆ·å‘½åç©ºé—´çš„æ¨¡å¼                     |
| `--uts string`                                     | å®¹å™¨çš„UTSå‘½åç©ºé—´                                            |
| `--restart string`                                 | å®¹å™¨çš„é‡å¯ç­–ç•¥ï¼ŒåŒ…æ‹¬noã€on-failure [:max-retry]ã€alwaysã€ unless-stopped ç­‰ |
| `--rm`                                             | å®¹å™¨é€€å‡ºåæ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œä¸èƒ½è·Ÿ-dåŒæ—¶ä½¿ç”¨                     |
| `-t, --tty`                                        | æ˜¯å¦åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼Œé»˜è®¤ä¸ºfalse                              |
| `--tmpfs list`                                     | æŒ‚è½½ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿåˆ°å®¹å™¨                                       |
| `--volume [=[[HOST-DIR:]CONTAINER-DIR[:OPTIONS]]]` | æŒ‚è½½ä¸»æœºä¸Šçš„æ–‡ä»¶å·åˆ°å®¹å™¨å†…                                   |
| `--volume-driver string`                           | æŒ‚è½½æ–‡ä»¶å·çš„é©±åŠ¨ç±»å‹                                         |
| `--volumes-from list`                              | ä»å…¶ä»–å®¹å™¨æŒ‚è½½å·                                             |
| `-w, --workdir string`                             | å®¹å™¨å†…çš„é»˜è®¤å·¥ä½œç›®å½•                                         |

#### ç¯å¢ƒå’Œé…ç½®ç›¸å…³

createå‘½ä»¤ä¸å®¹å™¨ç¯å¢ƒå’Œé…ç½®ç›¸å…³çš„é€‰é¡¹

| é€‰ é¡¹                   | è¯´ æ˜                                                        |
| ----------------------- | ------------------------------------------------------------ |
| `--add-host list`       | åœ¨å®¹å™¨å†…æ·»åŠ ä¸€ä¸ªä¸»æœºååˆ°IPåœ°å€çš„æ˜ å°„å…³ç³»ï¼ˆé€šè¿‡/etc/hostsæ–‡ä»¶ï¼‰ |
| `--device list`         | æ˜ å°„ç‰©ç†æœºä¸Šçš„è®¾å¤‡åˆ°å®¹å™¨å†…                                   |
| `--dns-search list`     | DNSæœç´¢åŸŸ                                                    |
| `--dns-option list`     | è‡ªå®šä¹‰çš„DNSé€‰é¡¹                                              |
| `--dns list`            | è‡ªå®šä¹‰çš„DNSæœåŠ¡å™¨                                            |
| `-e, --env list`        | æŒ‡å®šå®¹å™¨å†…ç¯å¢ƒå˜é‡                                           |
| `--env-file list`       | ä»æ–‡ä»¶ä¸­è¯»å–ç¯å¢ƒå˜é‡åˆ°å®¹å™¨å†…                                 |
| `-h, --hostname string` | æŒ‡å®šå®¹å™¨å†…çš„ä¸»æœºå                                           |
| `--ip string`           | æŒ‡å®šå®¹å™¨çš„IPv4åœ°å€                                           |
| `--ip6 string`          | æŒ‡å®šå®¹å™¨çš„IPv6åœ°å€                                           |
| `--link list`           | é“¾æ¥åˆ°å…¶ä»–å®¹å™¨                                               |
| `--link-local-ip list`  | å®¹å™¨çš„æœ¬åœ°é“¾æ¥åœ°å€åˆ—è¡¨                                       |
| `--mac-address string`  | æŒ‡å®šå®¹å™¨çš„Macåœ°å€                                            |
| `--name string`         | æŒ‡å®šå®¹å™¨çš„åˆ«å                                               |

#### èµ„æºé™åˆ¶å’Œå®‰å…¨ä¿æŠ¤ç›¸å…³

createå‘½ä»¤ä¸å®¹å™¨èµ„æºé™åˆ¶å’Œå®‰å…¨ä¿æŠ¤ç›¸å…³çš„é€‰é¡¹

| é€‰ é¡¹                            | è¯´ æ˜                                                        |
| -------------------------------- | ------------------------------------------------------------ |
| `--blkio-weight uint16`          | å®¹å™¨è¯»å†™å—è®¾å¤‡I/Oæ€§èƒ½æƒé‡ï¼Œé»˜è®¤ä¸º0                           |
| `--blkio-weight-device list`     | æŒ‡å®šå„ä¸ªå—è®¾å¤‡çš„I/Oæ€§èƒ½æƒé‡                                  |
| `-c, --cpu-shares int`           | å…è®¸å®¹å™¨ä½¿ç”¨CPUèµ„æºçš„ç›¸å¯¹æƒé‡,é»˜è®¤ä¸€ä¸ªå®¹å™¨èƒ½ç”¨æ»¡ä¸€ä¸ªæ ¸çš„CPU  |
| `--cap-add list`                 | å¢åŠ ç¶·å™¨çš„Linuxæ¡çŸ©å®‰å…¨èƒ½åŠ›                                  |
| `--cap-drop list`                | ç§»é™¤å®¹å™¨çš„ LinuxæŒ‡å®šå®‰å…¨èƒ½åŠ›                                 |
| `--cgroup-parent string`         | å®¹å™¨ groupsé™åˆ¶çš„åˆ›å»ºè·¯å¾„                                    |
| `--cidfile string`               | æŒ‡å®šå®¹å™¨çš„è¿›ç¨‹IDå·å†™åˆ°æ–‡ä»¶                                   |
| `--cpu-period int`               | é™åˆ¶å®¹å™¨åœ¨CFSè°ƒåº¦å™¨ä¸‹çš„CPUå ç”¨æ—¶é—´ç‰‡                         |
| `--cpuset-cpus string`           | é™åˆ¶å®¹å™¨èƒ½ä½¿ç”¨å“ªäº›CPUæ ¸å¿ƒ                                    |
| `--cpuset-mems string`           | NUMAæ¶æ„ä¸‹ä½¿ç”¨å“ªäº›æ ¸å¿ƒçš„å†…å­˜ï¼Ÿï¼Ÿ                             |
| `--cpu-quota int`                | é™åˆ¶å®¹å™¨åœ¨CFSè°ƒåº¦å™¨ä¸‹çš„CPUé…é¢                               |
| `--device-read-bps list`         | æŒ‚è½½è®¾å¤‡çš„è¯»ååç‡(ä»¥bpsä¸ºå•ä½)é™åˆ¶                          |
| `--device-write-bps list`        | æŒ‚è½½è®¾å¤‡çš„å†™ååç‡(ä»¥bpsä¸ºå•ä½)é™åˆ¶                          |
| `--device-read-iops list`        | æŒ‚è½½è®¾å¤‡çš„è¯»é€Ÿç‡(ä»¥æ¯ç§’i/oæ¬¡æ•°ä¸ºå•ä½)é™åˆ¶                    |
| `--device-write-iops list`       | æŒ‚è½½è®¾å¤‡çš„å†™é€Ÿç‡(ä»¥æ¯ç§’i/oæ¬¡æ•°ä¸ºå•ä½)é™åˆ¶                    |
| `--health-cmd string`            | æŒ‡å®šæ£€æŸ¥å®¹å™¨å¥åº·çŠ¶æ€çš„å‘½ä»¤                                   |
| `--health-interval duration`     | æ‰§è¡Œå¥åº·æ£€æŸ¥çš„é—´éš”æ—¶é—´,å•ä½å¯ä»¥ä¸ºmsã€sã€mæˆ–h                 |
| `--health-retries int`           | å¥åº·æ£€æŸ¥å¤±è´¥é‡è¯•æ¬¡æ•°,è¶…è¿‡åˆ™è®¤ä¸ºä¸å¥åº·                        |
| `--health-start-period duration` | å®¹å™¨å¯åŠ¨åè¿›è¡Œå¥åº·æ£€æŸ¥çš„ç­‰å¾…æ—¶é—´,å•ä½å¯ä»¥ä¸ºmsã€sã€mæˆ–h       |
| `--health-timeout duration`      | å¥åº·æ£€æŸ¥çš„æ‰§è¡Œè¶…æ—¶,å•ä½å¯ä»¥ä¸ºmsã€sã€mæˆ–h                     |
| `--no-healthcheck`               | æ˜¯å¦ç¦ç”¨å¥åº·æ£€æŸ¥                                             |
| `--init`                         | åœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸€ä¸ªinitè¿›ç¨‹,æ¥è´Ÿè´£å“åº”ä¿¡å·å’Œå¤„ç†åƒµå°¸çŠ¶æ€å­è¿›ç¨‹  |
| `--kernel-memory bytes`          | é™åˆ¶å®¹å™¨ä½¿ç”¨å†…æ ¸çš„å†…å­˜å¤§å°,å•ä½å¯ä»¥æ˜¯bã€kã€mæˆ–g              |
| `-m, --memory bytes`             | é™åˆ¶å®¹å™¨å†…åº”ç”¨ä½¿ç”¨çš„å†…å­˜,å•ä½å¯ä»¥æ˜¯bã€kã€mæˆ–g                |
| `--memory-reservation bytes`     | å½“ç³»ç»Ÿä¸­å†…å­˜è¿‡ä½æ—¶,å®¹å™¨ä¼šè¢«å¼ºåˆ¶é™åˆ¶å†…å­˜åˆ°ç»™å®šå€¼,é»˜è®¤æƒ…å†µä¸‹ç­‰äºå†…å­˜é™åˆ¶å€¼ |
| `--memory-swap bytes`            | é™åˆ¶å®¹å™¨ä½¿ç”¨å†…å­˜å’Œäº¤æ¢åŒºçš„æ€»å¤§å°                             |
| `--oom-kill-disable`             | å†…å­˜è€—å°½æ—¶æ˜¯å¦æ€æ­»å®¹å™¨                                       |
| `--oom-score-adj int`            | è°ƒæ•´å®¹å™¨çš„å†…å­˜è€—å°½å‚æ•°                                       |
| `--pids-limit int`               | é™åˆ¶å®¹å™¨çš„pidä¸ªæ•°                                            |
| `--privileged`                   | æ˜¯å¦ç»™å®¹å™¨é«˜æƒé™,è¿™æ„å‘³ç€å®¹å™¨å†…åº”ç”¨å°†ä¸å—æƒé™çš„é™åˆ¶.ä¸€èˆ¬ä¸æ¨è |
| `--read-only`                    | æ˜¯å¦è®©å®¹å™¨å†…çš„æ–‡ä»¶ç³»ç»Ÿåªè¯»                                   |
| `--security-opt list`            | æŒ‡å®šä¸€äº›å®‰å…¨å‚æ•°,åŒ…æ‹¬æƒé™ã€å®‰å…¨èƒ½åŠ›ã€ apparmorç­‰             |
| `--stop-signal string`           | æŒ‡å®šåœæ­¢å®¹å™¨çš„ç³»ç»Ÿä¿¡å·(default "SIGTERM")                    |
| `--shm-size bytes`               | dev/shmçš„å¤§å°                                                |
| `--sig-proxy=true|false`         | æ˜¯å¦ä»£ç†æ”¶åˆ°çš„ä¿¡å·ç»™åº”ç”¨,é»˜è®¤ä¸ºtrue,ä¸èƒ½ä»£ç† SIGCHLDã€SIGSTOPå’Œ SIGKILLä¿¡å· |
| `--memory-swappiness int`        | è°ƒæ•´å®¹å™¨çš„å†…å­˜äº¤æ¢åŒºå‚æ•°ï¼ˆ0åˆ°100ï¼‰ï¼ˆé»˜è®¤-1ï¼‰                 |
| `-u, --user string`              | æŒ‡å®šåœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤çš„ç”¨æˆ·ä¿¡æ¯                               |
| `--userns string`                | æŒ‡å®šç”¨æˆ·å‘½åç©ºé—´                                             |
| `--ulimit ulimit`                | é€šè¿‡ulimitæ¥é™åˆ¶æœ€å¤§æ–‡ä»¶æ•°ã€æœ€å¤§è¿›ç¨‹æ•°ç­‰                     |

## start-å¯åŠ¨å®¹å™¨

å¯ä»¥ä½¿ç”¨`docker [container] start`å‘½ä»¤æ¥å¯åŠ¨å¤„äºåœæ­¢çŠ¶æ€çš„å®¹å™¨ï¼š

```
docker start [OPTIONS] CONTAINER [CONTAINER...]
```

![image-20210222210317655](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222210317655.png)

```
docker start --help
```

`ä¾‹å­`ï¼šå¯åŠ¨åˆšåˆ›å»ºçš„ubuntuå®¹å™¨afï¼š

```
$ docker start af
af
```

æ­¤æ—¶ï¼Œé€šè¿‡docker pså‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼š

```bash
$ docker ps
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
af8f4f922daf ubuntu:latest "/bin/bash" 2 minutes ago Up 7 seconds silly_euler
```

### é€‰é¡¹

- `-a, --attach`ï¼š
  Attach STDOUT/STDERR and forward signals

- `--detach-keys string`ï¼š
  Override the key sequence for detaching a container

  ä»attachæ¨¡å¼é€€å‡ºçš„å¿«æ·é”®

- `-i, --interactive`ï¼š
Attach container's STDIN

## run-æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨

é™¤äº†åˆ›å»ºå®¹å™¨åé€šè¿‡startå‘½ä»¤æ¥å¯åŠ¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨ã€‚

æ‰€éœ€è¦çš„å‘½ä»¤ä¸»è¦ä¸º`docker[container]run`ï¼Œç­‰ä»·äºå…ˆæ‰§è¡Œ`docker[container]create`å‘½ä»¤ï¼Œå†æ‰§è¡Œ`docker[container]start`å‘½ä»¤ã€‚

```
docker run [OPTIONS] IMAGE [COMMAND] [ARG...]
```

å‚æ•°å’Œcreateä¸€è‡´ï¼Œç›´æ¥çœ‹ä¸Šé¢éƒ¨åˆ†å³å¯ã€‚

```
docker run --help
```

`ä¾‹å­`ï¼šè¾“å‡ºä¸€ä¸ªâ€œHelloWorldâ€ï¼Œä¹‹åå®¹å™¨è‡ªåŠ¨ç»ˆæ­¢ï¼š

```
docker run busybox:latest /bin/echo 'Hello world'
```

![image-20210222231659785](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222231659785.png)

## runæš—åœ°é‡Œçš„æ“ä½œ

å½“åˆ©ç”¨docker[container]runæ¥åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨æ—¶ï¼ŒDockeråœ¨åå°è¿è¡Œçš„æ ‡å‡†æ“ä½œåŒ…æ‹¬ï¼š

- æ£€æŸ¥æœ¬åœ°æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é•œåƒï¼Œä¸å­˜åœ¨å°±ä»å…¬æœ‰ä»“åº“ä¸‹è½½ï¼›
- åˆ©ç”¨é•œåƒåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œå¹¶å¯åŠ¨è¯¥å®¹å™¨ï¼›
- åˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿç»™å®¹å™¨ï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å†™å±‚ï¼›
- ä»å®¿ä¸»ä¸»æœºé…ç½®çš„ç½‘æ¡¥æ¥å£ä¸­æ¡¥æ¥ä¸€ä¸ªè™šæ‹Ÿæ¥å£åˆ°å®¹å™¨ä¸­å»ï¼›
- ä»ç½‘æ¡¥çš„åœ°å€æ± é…ç½®ä¸€ä¸ªIPåœ°å€ç»™å®¹å™¨ï¼›
- æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åºï¼›
- æ‰§è¡Œå®Œæ¯•åå®¹å™¨è¢«è‡ªåŠ¨ç»ˆæ­¢ã€‚

## -it äº¤äº’

ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨ä¸€ä¸ªbashç»ˆç«¯ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼š

```bash
$ docker run -it busybox
root@af8bae53bdd3:/#
# æˆ–
$ docker run -it busybox:latest /bin/sh
root@af8bae53bdd3:/#
# å¯ä»¥æ ¹æ®ä¹‹å‰é•œåƒçŸ¥è¯†å¾—åˆ°
virhuiaivirhuiai@virhuiaideMBP RamDisk % docker inspect busybox:latest -f {{".ContainerConfig.Cmd"}}
[/bin/sh -c #(nop)  CMD ["sh"]]
virhuiaivirhuiai@virhuiaideMBP RamDisk % docker inspect busybox:latest -f {{".Config.Cmd"}} 
[sh]
```

![image-20210222232402960](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222232402960.png)

![image-20210222232341348](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222232341348.png)

å…¶ä¸­ï¼š

- `-t`é€‰é¡¹è®©Dockeråˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼ˆpseudo-ttyï¼‰å¹¶ç»‘å®šåˆ°å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¸Š
- `-i`åˆ™è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€ã€‚

## é€€å‡ºçš„é”™è¯¯ä»£ç 

å¯¹äºæ‰€åˆ›å»ºçš„bashå®¹å™¨ï¼Œå½“ç”¨æˆ·ä½¿ç”¨exitå‘½ä»¤é€€å‡ºbashè¿›ç¨‹ä¹‹åï¼Œå®¹å™¨ä¹Ÿä¼šè‡ªåŠ¨é€€å‡ºã€‚è¿™æ˜¯å› ä¸ºå¯¹äºå®¹å™¨æ¥è¯´ï¼Œå½“å…¶ä¸­çš„åº”ç”¨é€€å‡ºåï¼Œå®¹å™¨çš„ä½¿å‘½å®Œæˆï¼Œä¹Ÿå°±æ²¡æœ‰ç»§ç»­è¿è¡Œçš„å¿…è¦äº†ã€‚

å¯ä»¥ä½¿ç”¨docker container wait CONTAINER[CONTAINER...]å­å‘½ä»¤æ¥ç­‰å¾…å®¹å™¨é€€å‡ºï¼Œå¹¶æ‰“å°é€€å‡ºè¿”å›ç»“æœã€‚

æŸäº›æ—¶å€™ï¼Œæ‰§è¡Œdocker[container]runæ—¶å€™å› ä¸ºå‘½ä»¤æ— æ³•æ­£å¸¸æ‰§è¡Œå®¹å™¨ä¼šå‡ºé”™ç›´æ¥é€€å‡ºï¼Œæ­¤æ—¶å¯ä»¥æŸ¥çœ‹é€€å‡ºçš„é”™è¯¯ä»£ç ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œå¸¸è§é”™è¯¯ä»£ç åŒ…æ‹¬ï¼š

- 125:Docker daemonæ‰§è¡Œå‡ºé”™ï¼Œä¾‹å¦‚æŒ‡å®šäº†ä¸æ”¯æŒçš„Dockerå‘½ä»¤å‚æ•°ï¼›
- 126ï¼šæ‰€æŒ‡å®šå‘½ä»¤æ— æ³•æ‰§è¡Œï¼Œä¾‹å¦‚æƒé™å‡ºé”™ï¼›
- 127ï¼šå®¹å™¨å†…å‘½ä»¤æ— æ³•æ‰¾åˆ°ã€‚

å‘½ä»¤æ‰§è¡Œåå‡ºé”™ï¼Œä¼šé»˜è®¤è¿”å›å‘½ä»¤çš„é€€å‡ºé”™è¯¯ç ã€‚

## -d å®ˆæŠ¤æ€è¿è¡Œ

éœ€è¦è®©Dockerå®¹å™¨åœ¨åå°ä»¥å®ˆæŠ¤æ€ï¼ˆDaemonizedï¼‰å½¢å¼è¿è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ -då‚æ•°æ¥å®ç°ã€‚

`ä¾‹å¦‚`:ä¸‹é¢çš„å‘½ä»¤ä¼šåœ¨åå°è¿è¡Œå®¹å™¨ï¼š

```
docker run -d busybox  /bin/sh -c "while true; do echo hello world; sleep 1; done"
```

![image-20210222233049956](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222233049956.png)

å®¹å™¨å¯åŠ¨åä¼šè¿”å›ä¸€ä¸ªå”¯ä¸€çš„idï¼Œä¹Ÿå¯ä»¥é€šè¿‡docker psæˆ–docker container lså‘½ä»¤æ¥æŸ¥çœ‹å®¹å™¨ä¿¡æ¯

![image-20210222233059791](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222233059791.png)

## logs=æŸ¥çœ‹å®¹å™¨è¾“å‡ºä¿¡æ¯

```
docker container logs --help
```

![image-20210222235853770](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222235853770.png)

`ä¾‹å­`ï¼šæŸ¥çœ‹æŸå®¹å™¨çš„è¾“å‡ºï¼š

å…ˆè¿è¡Œä¸€ä¸ªä¸æ–­è¾“å‡ºhello worldçš„å®¹å™¨

```bash
$docker run --name dtest -d busybox  /bin/sh -c "while true; do echo hello world; sleep 1; done"
```

å†ç”¨logså‘½ä»¤æŸ¥çœ‹

```bash
$ docker logs dtest
hello world
. . .
```

æ•ˆæœå¦‚å›¾ï¼š

![image-20210222235750489](/assets/2021-02-21-Dockerå®¹å™¨.assets/image-20210222235750489.png)

### logsé€‰é¡¹

- `--details`ï¼š
  Show extra details provided to logs
  æ‰“å°è¯¦ç»†ä¿¡æ¯ï¼›
- `-f, --follow`ï¼š
  Follow log output
  æŒç»­ä¿æŒè¾“å‡ºï¼›
- `--since string`ï¼š
  Show logs since timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)
  è¾“å‡ºä»æŸä¸ªæ—¶é—´å¼€å§‹çš„æ—¥å¿—ï¼›
- `-n, --tail string`ï¼š
  Number of lines to show from the end of the logs (default  "all")
  è¾“å‡ºæœ€è¿‘çš„è‹¥å¹²æ—¥å¿—ï¼›
- `-t, --timestamps`ï¼š
  Show timestamps
  æ˜¾ç¤ºæ—¶é—´æˆ³ä¿¡æ¯ï¼›
- `--until string`ï¼š
  Show logs before a timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)
  è¾“å‡ºæŸä¸ªæ—¶é—´ä¹‹å‰çš„æ—¥å¿—ã€‚

## åœæ­¢å®¹å™¨

### pause-æš‚åœå®¹å™¨

```
docker run --name test --rm -it ubuntu bash
docker pause test
docker ps
```

```bash
$ docker run --name test --rm -it ubuntu bash
$ docker pause test
$ docker ps
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
893c811cf845 ubuntu "bash" 2 seconds ago Up 12 seconds (Paused) test
```

### unpause-æ¢å¤æš‚åœå®¹å™¨

å¤„äºpausedçŠ¶æ€çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨docker [container]unpause CONTAINER [CONTAINER...]å‘½ä»¤æ¥æ¢å¤åˆ°è¿è¡ŒçŠ¶æ€ã€‚

### stopç»ˆæ­¢å®¹å™¨ï¼Œå˜ä¸ºåœæ­¢çŠ¶æ€

è¯¥å‘½ä»¤ä¼šé¦–å…ˆå‘å®¹å™¨å‘é€SIGTERMä¿¡å·ï¼Œç­‰å¾…ä¸€æ®µè¶…æ—¶æ—¶é—´åï¼ˆé»˜è®¤ä¸º10ç§’ï¼‰ï¼Œå†å‘é€SIGKILLä¿¡å·æ¥ç»ˆæ­¢å®¹å™¨ï¼š

```bash
$ docker stop ce5
ce5
```

å½“Dockerå®¹å™¨ä¸­æŒ‡å®šçš„åº”ç”¨ç»ˆç»“æ—¶ï¼Œå®¹å™¨ä¹Ÿä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚

ä¾‹å¦‚ï¼Œåªå¯åŠ¨äº†ä¸€ä¸ªç»ˆç«¯çš„å®¹å™¨ï¼Œç”¨æˆ·é€šè¿‡exitå‘½ä»¤æˆ–Ctrl+dæ¥é€€å‡ºç»ˆç«¯æ—¶ï¼Œæ‰€åˆ›å»ºçš„å®¹å™¨ç«‹åˆ»ç»ˆæ­¢ï¼Œå¤„äºstoppedçŠ¶æ€ã€‚

å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œå¯ä»¥é€šè¿‡docker [container] startå‘½ä»¤æ¥é‡æ–°å¯åŠ¨ï¼Œè¿™ä¸ªçœ‹å‰é¢çš„ä»‹ç»ï¼šstart-å¯åŠ¨å®¹å™¨ã€‚

###  restarté‡å¯å®¹å™¨

docker [container] restartå‘½ä»¤ä¼šå°†ä¸€ä¸ªè¿è¡Œæ€çš„å®¹å™¨å…ˆç»ˆæ­¢ï¼Œç„¶åå†é‡æ–°å¯åŠ¨ï¼š

```bash
$ docker restart ce554267d7a4
ce554267d7a4
$ docker ps
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
ce554267d7a4  ubuntu:latest  "/bin/sh  -c  'while  t     5  minutes  ago  Up  14  seconds
determined_pike
```

### pruneæ¸…é™¤æ‰æ‰€æœ‰å¤„äºåœæ­¢çŠ¶æ€çš„å®¹å™¨

æ‰§è¡Œ`docker container prune`å‘½ä»¤ï¼Œä¼šè‡ªåŠ¨æ¸…é™¤æ‰æ‰€æœ‰å¤„äºåœæ­¢çŠ¶æ€çš„å®¹å™¨ã€‚

```
prune - å¿…åº”è¯å…¸
ç¾[prun]è‹±[pruËn]
v.ç²¾ç®€ï¼›ä¿®å‰ª(æ ‘æœ¨çš„æå¶)ï¼›ä¿®æï¼›åˆ å»
n.ã€é£Ÿã€‘æ¢…å¹²ï¼›è¥¿æ¢…è„¯
ç½‘ç»œæå­ï¼›å‰ªé™¤ï¼›å‰ªæ
```

### killå¼ºè¡Œç»ˆæ­¢å®¹å™¨

å¯ä»¥é€šè¿‡docker [container] killç›´æ¥å‘é€SIGKILLä¿¡å·æ¥å¼ºè¡Œç»ˆæ­¢å®¹å™¨ã€‚

## è¿›å…¥å®¹å™¨

### exec -itå‘½ä»¤ï¼Œæ¨è

å¯ä»¥åœ¨è¿è¡Œä¸­å®¹å™¨å†…ç›´æ¥æ‰§è¡Œä»»æ„å‘½ä»¤

æ¯”è¾ƒé‡è¦çš„å‚æ•°æœ‰ï¼š

-  -d, --detachï¼šåœ¨å®¹å™¨ä¸­åå°æ‰§è¡Œå‘½ä»¤ï¼›
-  --detach-keys=""ï¼šæŒ‡å®šå°†å®¹å™¨åˆ‡å›åå°çš„æŒ‰é”®ï¼›
-  -e, --env=[]ï¼šæŒ‡å®šç¯å¢ƒå˜é‡åˆ—è¡¨ï¼›
-  -i,  --interactive=true|falseï¼šæ‰“å¼€æ ‡å‡†è¾“å…¥æ¥å—ç”¨æˆ·è¾“å…¥å‘½ä»¤ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼›
-  --privileged=true|falseï¼šæ˜¯å¦ç»™æ‰§è¡Œå‘½ä»¤ä»¥é«˜æƒé™ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼›
-  -t,  --tty=true|falseï¼šåˆ†é…ä¼ªç»ˆç«¯ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼›
-  -u, --user=""ï¼šæ‰§è¡Œå‘½ä»¤çš„ç”¨æˆ·åæˆ–IDã€‚

ä¾‹å¦‚

```bash
$ docker exec -it 243c32535da7   /bin/bash
root@243c32535da7:/#
```

å¯ä»¥çœ‹åˆ°ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„bashç»ˆç«¯ï¼Œåœ¨ä¸å½±å“å®¹å™¨å†…å…¶ä»–åº”ç”¨çš„å‰æä¸‹ï¼Œç”¨æˆ·å¯ä»¥ä¸å®¹å™¨è¿›è¡Œäº¤äº’ã€‚æ³¨æ„é€šè¿‡æŒ‡å®š`-it`å‚æ•°æ¥ä¿æŒæ ‡å‡†è¾“å…¥æ‰“å¼€ï¼Œå¹¶ä¸”åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚é€šè¿‡execå‘½ä»¤å¯¹å®¹å™¨æ‰§è¡Œæ“ä½œæ˜¯æœ€ä¸ºæ¨èçš„æ–¹å¼ã€‚

### attachå‘½ä»¤-ä¸æ¨è

è¿™ä¸ªå‘½ä»¤æ”¯æŒä¸‰ä¸ªä¸»è¦é€‰é¡¹ï¼š

-  --detach-keys[=[]]ï¼šæŒ‡å®šé€€å‡ºattachæ¨¡å¼çš„å¿«æ·é”®åºåˆ—ï¼Œé»˜è®¤æ˜¯CTRL-p  CTRL-qï¼›
-  --no-stdin=true|falseï¼šæ˜¯å¦å…³é—­æ ‡å‡†è¾“å…¥ï¼Œé»˜è®¤æ˜¯ä¿æŒæ‰“å¼€ï¼›
-  --sig-proxy=true|falseï¼šæ˜¯å¦ä»£ç†æ”¶åˆ°çš„ç³»ç»Ÿä¿¡å·ç»™åº”ç”¨è¿›ç¨‹ï¼Œé»˜è®¤ä¸ºtrueã€‚

```
docker run -itd ubuntu
docker ps
docker attach nostalgic_hypatia
```

ç¼ºç‚¹ï¼š

- åŒæ­¥æ˜¾ç¤º:å¤šä¸ªçª—å£åŒæ—¶attachåˆ°åŒä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œæ‰€æœ‰çª—å£éƒ½ä¼šåŒæ­¥æ˜¾ç¤ºï¼›
- å‘½ä»¤é˜»å¡:å½“æŸä¸ªçª—å£å› å‘½ä»¤é˜»å¡æ—¶ï¼Œå…¶ä»–çª—å£ä¹Ÿæ— æ³•æ‰§è¡Œæ“ä½œäº†ã€‚

## rmåˆ é™¤å®¹å™¨

```
docker [container] rm
```

ä¸»è¦æ”¯æŒçš„é€‰é¡¹åŒ…æ‹¬ï¼š

-  -f, --force=falseï¼šæ˜¯å¦å¼ºè¡Œç»ˆæ­¢å¹¶åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼›
-  -l, --link=falseï¼šåˆ é™¤å®¹å™¨çš„è¿æ¥ï¼Œä½†ä¿ç•™å®¹å™¨ï¼›
-  -v, --volumes=falseï¼šåˆ é™¤å®¹å™¨æŒ‚è½½çš„æ•°æ®å·ã€‚

ä¾‹å¦‚ï¼ŒæŸ¥çœ‹å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œå¹¶åˆ é™¤ï¼š

```bash
$ docker ps -a
CONTAINER ID     IMAGE        COMMAND        CREATED        STATUS        PORTS        NAMES
ce554267d7a4      ubuntu:latest     "/bin/sh -c 'while t     3 minutes agoExited (-1)
13 seconds ago                    determined_pike
d58050081fe3     ubuntu:latest     "/bin/bash"                About an hour ago
Exited (0)   About an hour ago berserk_brattain
e812617b41f6     ubuntu:latest     "echo 'hello! I am h     2 hours ago   Exited (0)
3 minutes ago

$ docker rm ce554267d7a4
ce554267d7a4
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker rmå‘½ä»¤åªèƒ½åˆ é™¤å·²ç»å¤„äºç»ˆæ­¢æˆ–é€€å‡ºçŠ¶æ€çš„å®¹å™¨ï¼Œå¹¶ä¸èƒ½åˆ é™¤è¿˜å¤„äºè¿è¡ŒçŠ¶æ€çš„å®¹å™¨ã€‚

å¦‚æœè¦ç›´æ¥åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼Œå¯ä»¥æ·»åŠ -få‚æ•°ã€‚Dockerä¼šå…ˆå‘é€SIGKILLä¿¡å·ç»™å®¹å™¨ï¼Œç»ˆæ­¢å…¶ä¸­çš„åº”ç”¨ï¼Œä¹‹åå¼ºè¡Œåˆ é™¤ã€‚

## å¯¼å‡ºå®¹å™¨

å¯¼å‡ºå®¹å™¨æ˜¯æŒ‡ï¼Œå¯¼å‡ºä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®¹å™¨åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸ç®¡æ­¤æ—¶è¿™ä¸ªå®¹å™¨æ˜¯å¦å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å¯ä»¥ä½¿ç”¨docker [container]exportå‘½ä»¤ï¼Œè¯¥å‘½ä»¤æ ¼å¼ä¸ºï¼š

```bash
docker [container] export [-o|--output[=""]] CONTAINER
```

å…¶ä¸­ï¼Œå¯ä»¥é€šè¿‡-oé€‰é¡¹æ¥æŒ‡å®šå¯¼å‡ºçš„taræ–‡ä»¶åï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡é‡å®šå‘æ¥å®ç°ã€‚

é¦–å…ˆï¼ŒæŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
$ docker ps -a
CONTAINER ID        IMAGE        COMMAND        CREATED        STATUS      PORTS      NAMES
ce554267d7a4     ubuntu:latest     "/bin/sh -c 'while t"    3 minutes ago
Exited (-1) 13 seconds ago     determined_pike
d58050081fe3     ubuntu:latest     "/bin/bash"                About an hour ago
Exited (0) About an hour ago     berserk_brattain
e812617b41f6     ubuntu:latest     "echo 'hello! I am h"    2 hours ago
Exited (0) 3 minutes ago      silly_leakey
```

åˆ†åˆ«å¯¼å‡ºce554267d7a4å®¹å™¨å’Œe812617b41f6å®¹å™¨åˆ°æ–‡ä»¶test_for_run.taræ–‡ä»¶å’Œtest_for_stop.taræ–‡ä»¶ï¼š

```bash
$ docker export -o test_for_run.tar ce5
$ ls
test_for_run.tar
$ docker export e81 >test_for_stop.tar
$ ls
test_for_run.tar test_for_stop.tar
```

ä¹‹åï¼Œå¯å°†å¯¼å‡ºçš„taræ–‡ä»¶ä¼ è¾“åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œç„¶åå†é€šè¿‡å¯¼å…¥å‘½ä»¤å¯¼å…¥åˆ°ç³»ç»Ÿä¸­ï¼Œå®ç°å®¹å™¨çš„è¿ç§»ã€‚

## å¯¼å…¥å®¹å™¨

å¯¼å‡ºçš„æ–‡ä»¶åˆå¯ä»¥ä½¿ç”¨docker [container] importå‘½ä»¤å¯¼å…¥å˜æˆé•œåƒï¼Œè¯¥å‘½ä»¤æ ¼å¼ä¸ºï¼š

```bash
docker  import  [-c|--change[=[]]]  [-m|--message[=MESSAGE]]  file|URL|-[REPOSITORY[:TAG]]
```

ç”¨æˆ·å¯ä»¥é€šè¿‡-c, --change=[]é€‰é¡¹åœ¨å¯¼å…¥çš„åŒæ—¶æ‰§è¡Œå¯¹å®¹å™¨è¿›è¡Œä¿®æ”¹çš„DockerfileæŒ‡ä»¤ï¼ˆå¯å‚è€ƒåç»­ç›¸å…³ç« èŠ‚ï¼‰ã€‚

ä¸‹é¢å°†å¯¼å‡ºçš„test_for_run.taræ–‡ä»¶å¯¼å…¥åˆ°ç³»ç»Ÿä¸­ï¼š

```bash
$ docker import test_for_run.tar - test/ubuntu:v1.0
$ docker images
REPOSITORY         TAG         IMAGE ID          CREATED                  VIRTUAL SIZE
test/ubuntu        v1.0        9d37a6082e97      About a minute ago       171.3 MB
```

## å¯¼å…¥é•œåƒå’Œå¯¼å…¥å®¹å™¨çš„åŒºåˆ«

å¯¼å…¥é•œåƒæ–‡ä»¶å‘½ä»¤docker loadï¼Œä¸docker [container] importå‘½ä»¤ååˆ†ç±»ä¼¼ã€‚

å®é™…ä¸Šï¼Œæ—¢å¯ä»¥ä½¿ç”¨docker loadå‘½ä»¤æ¥å¯¼å…¥é•œåƒå­˜å‚¨æ–‡ä»¶åˆ°æœ¬åœ°é•œåƒåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨docker [container]  importå‘½ä»¤æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ã€‚è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºï¼šå®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰çš„å†å²è®°å½•å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆå³ä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯æ›´å¤§ã€‚æ­¤å¤–ï¼Œä»å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ã€‚

> 	ä¸å¯¼å…¥ é•œåƒçš„loadå‘½ä»¤å¯¹æ¯”
> - å®¹å™¨å¿«ç…§æ–‡ä»¶ä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶
> - é•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯æ›´å¤§
> - æ­¤å¤–ï¼Œä»å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯

## æŸ¥çœ‹å®¹å™¨è¯¦æƒ…

æŸ¥çœ‹å®¹å™¨è¯¦æƒ…å¯ä»¥ä½¿ç”¨docker container inspect [OPTIONS]CONTAINER [CONTAINER...]å­å‘½ä»¤ã€‚

ä¾‹å¦‚ï¼ŒæŸ¥çœ‹æŸå®¹å™¨çš„å…·ä½“ä¿¡æ¯ï¼Œä¼šä»¥jsonæ ¼å¼è¿”å›åŒ…æ‹¬å®¹å™¨Idã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ã€çŠ¶æ€ã€é•œåƒã€é…ç½®ç­‰åœ¨å†…çš„å„é¡¹ä¿¡æ¯ï¼š

```bash
$ docker container inspect test
[
{
"Id": "2d4be6a584ec23e2a0b3eabb8909fd51960c11031df09513c6ba863c919bf2e8",
"Created": "2018-02-21T05:04:17.089267701Z",
"Path": "/portainer",
"Args": [],
"State": {
        "Status": "running",
        ...
}
]
```

## topæŸ¥çœ‹å®¹å™¨å†…è¿›ç¨‹

æŸ¥çœ‹å®¹å™¨å†…è¿›ç¨‹å¯ä»¥ä½¿ç”¨docker [container] top [OPTIONS]CONTAINER [CONTAINER...]å­å‘½ä»¤ã€‚

è¿™ä¸ªå­å‘½ä»¤ç±»ä¼¼äºLinuxç³»ç»Ÿä¸­çš„topå‘½ä»¤ï¼Œä¼šæ‰“å°å‡ºå®¹å™¨å†…çš„è¿›ç¨‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬PIDã€ç”¨æˆ·ã€æ—¶é—´ã€å‘½ä»¤ç­‰ã€‚ä¾‹å¦‚ï¼ŒæŸ¥çœ‹æŸå®¹å™¨å†…çš„è¿›ç¨‹ä¿¡æ¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š

```bash
$ docker top test
PID                     USER                     TIME                    COMMAND
5730                    0                        0:00                    /portainer
```

## statsæŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯

æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯å¯ä»¥ä½¿ç”¨`docker [container] stats [OPTIONS] [CONTAINER...]`å­å‘½ä»¤ï¼Œä¼šæ˜¾ç¤ºCPUã€å†…å­˜ã€å­˜å‚¨ã€ç½‘ç»œç­‰ä½¿ç”¨æƒ…å†µçš„ç»Ÿè®¡ä¿¡æ¯ã€‚

æ”¯æŒé€‰é¡¹åŒ…æ‹¬ï¼š

-  -a, -allï¼šè¾“å‡ºæ‰€æœ‰å®¹å™¨ç»Ÿè®¡ä¿¡æ¯ï¼Œé»˜è®¤ä»…åœ¨è¿è¡Œä¸­ï¼›
-  -format stringï¼šæ ¼å¼åŒ–è¾“å‡ºä¿¡æ¯ï¼›
-  -no-streamï¼šä¸æŒç»­è¾“å‡ºï¼Œé»˜è®¤ä¼šè‡ªåŠ¨æ›´æ–°æŒç»­å®æ—¶ç»“æœï¼›
-  -no-truncï¼šä¸æˆªæ–­è¾“å‡ºä¿¡æ¯ã€‚

ä¾‹å¦‚ï¼ŒæŸ¥çœ‹å½“å‰è¿è¡Œä¸­å®¹å™¨çš„ç³»ç»Ÿèµ„æºä½¿ç”¨ç»Ÿè®¡ï¼š

```bash
CONTAINER ID NAME CPU % MEM USAGE / LIMIT MEM % NET I/O BLOCK I/O PIDS
2d4be6a584ec test 0.00% 3.164MiB / 1.952GiB    0.16% 2.37kB / 0B 0B / 65.5kB 4
```

## å¤åˆ¶æ–‡ä»¶

container cpå‘½ä»¤æ”¯æŒåœ¨å®¹å™¨å’Œä¸»æœºä¹‹é—´å¤åˆ¶æ–‡ä»¶ã€‚å‘½ä»¤æ ¼å¼ä¸º

```
docker [container] cp [OPTIONS]  CONTAINER:SRC_PATHDEST_PATH|
```

æ”¯æŒçš„é€‰é¡¹åŒ…æ‹¬ï¼š

-  -a,  -archiveï¼šæ‰“åŒ…æ¨¡å¼ï¼Œå¤åˆ¶æ–‡ä»¶ä¼šå¸¦æœ‰åŸå§‹çš„uid/gidä¿¡æ¯ï¼›
-  -L,  -follow-linkï¼šè·Ÿéšè½¯è¿æ¥ã€‚å½“åŸè·¯å¾„ä¸ºè½¯è¿æ¥æ—¶ï¼Œé»˜è®¤åªå¤åˆ¶é“¾æ¥ä¿¡æ¯ï¼Œä½¿ç”¨è¯¥é€‰é¡¹ä¼šå¤åˆ¶é“¾æ¥çš„ç›®æ ‡å†…å®¹ã€‚

ä¾‹å¦‚ï¼Œå°†æœ¬åœ°çš„è·¯å¾„dataå¤åˆ¶åˆ°testå®¹å™¨çš„/tmpè·¯å¾„ä¸‹ï¼š

```bash
docker [container] cp data test:/tmp/
```

## æŸ¥çœ‹å˜æ›´

container diffæŸ¥çœ‹å®¹å™¨å†…æ–‡ä»¶ç³»ç»Ÿçš„å˜æ›´ã€‚å‘½ä»¤æ ¼å¼ä¸º

```
docker[container] diff CONTAINER
```

ä¾‹å¦‚ï¼ŒæŸ¥çœ‹testå®¹å™¨å†…çš„æ•°æ®ä¿®æ”¹ï¼š

```bash
$ docker container diff test
C /root
A /root/.bash_history
C /tmp
A /tmp/Dockerfile
A /tmp/etcd-test
```

## æŸ¥çœ‹ç«¯å£æ˜ å°„

container portå‘½ä»¤å¯ä»¥æŸ¥çœ‹å®¹å™¨çš„ç«¯å£æ˜ å°„æƒ…å†µã€‚å‘½ä»¤æ ¼å¼ä¸ºdocker container port CONTAINER[PRIVATE_PORT[/PROTO]]ã€‚ä¾‹å¦‚ï¼ŒæŸ¥çœ‹testå®¹å™¨çš„ç«¯å£æ˜ å°„æƒ…å†µï¼š

```bash
$ docker container port test
9000/tcp -> 0.0.0.0:9000
```

## æ›´æ–°é…ç½®

container updateå‘½ä»¤å¯ä»¥æ›´æ–°å®¹å™¨çš„ä¸€äº›è¿è¡Œæ—¶é…ç½®ï¼Œä¸»è¦æ˜¯ä¸€äº›èµ„æºé™åˆ¶ä»½é¢ã€‚å‘½ä»¤æ ¼å¼ä¸ºdocker [container] update[OPTIONS] CONTAINER [CONTAINER...]ã€‚

æ”¯æŒçš„é€‰é¡¹åŒ…æ‹¬ï¼š

-  -blkio-weight uint16ï¼šæ›´æ–°å—IOé™åˆ¶ï¼Œ10ï½1000ï¼Œé»˜è®¤å€¼ä¸º0ï¼Œä»£è¡¨ç€æ— é™åˆ¶ï¼›
-  -cpu-period intï¼šé™åˆ¶CPUè°ƒåº¦å™¨CFSï¼ˆCompletelyFair Schedulerï¼‰ä½¿ç”¨æ—¶é—´ï¼Œå•ä½ä¸ºå¾®ç§’ï¼Œæœ€å°1000ï¼›
-  -cpu-quota intï¼šé™åˆ¶CPUè°ƒåº¦å™¨CFSé…é¢ï¼Œå•ä½ä¸ºå¾®ç§’ï¼Œæœ€å°1000ï¼›
-  -cpu-rt-period  intï¼šé™åˆ¶CPUè°ƒåº¦å™¨çš„å®æ—¶å‘¨æœŸï¼Œå•ä½ä¸ºå¾®ç§’ï¼›
-  -cpu-rt-runtime intï¼šé™åˆ¶CPUè°ƒåº¦å™¨çš„å®æ—¶è¿è¡Œæ—¶ï¼Œå•ä½ä¸ºå¾®ç§’ï¼›
-  -c, -cpu-shares intï¼šé™åˆ¶CPUä½¿ç”¨ä»½é¢ï¼›
-  -cpus decimalï¼šé™åˆ¶CPUä¸ªæ•°ï¼›
-  -cpuset-cpus  stringï¼šå…è®¸ä½¿ç”¨çš„CPUæ ¸ï¼Œå¦‚0-3,0,1ï¼›
-  -cpuset-mems stringï¼šå…è®¸ä½¿ç”¨çš„å†…å­˜å—ï¼Œå¦‚0-3,0,1ï¼›
-  -kernel-memory bytesï¼šé™åˆ¶ä½¿ç”¨çš„å†…æ ¸å†…å­˜ï¼›
-  -m, -memory bytesï¼šé™åˆ¶ä½¿ç”¨çš„å†…å­˜ï¼›
-  -memory-reservation bytesï¼šå†…å­˜è½¯é™åˆ¶ï¼›
-  -memory-swap  bytesï¼šå†…å­˜åŠ ä¸Šç¼“å­˜åŒºçš„é™åˆ¶ï¼Œ-1è¡¨ç¤ºä¸ºå¯¹ç¼“å†²åŒºæ— é™åˆ¶ï¼›
-  -restart stringï¼šå®¹å™¨é€€å‡ºåçš„é‡å¯ç­–ç•¥ã€‚

ä¾‹å¦‚ï¼Œé™åˆ¶æ€»é…é¢ä¸º1ç§’ï¼Œå®¹å™¨testæ‰€å ç”¨æ—¶é—´ä¸º10%ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
$ docker update --cpu-quota 1000000 test
test
$ docker update --cpu-period 100000 test
test
```

